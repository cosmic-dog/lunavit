"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};gambio.widgets.module("payone_checkout",[],function(e){var t=$(this),a={},n=$.extend(!0,{},a,e),o=!0,l={},i=function(e){var t=$("form#checkout_payment").get(0).elements.payment.value;"payone_cc"===t&&(o&&console.log("payone cc check triggered"),e.preventDefault(),p1cc_check())},c=function(){$("select#otrans_type").on("change",function(e){var t=$(this).val(),a=$(this).closest("table.payone_otrans_data"),n=$("tr.datarow",a);n.hide(),$(".for_"+t).show(),"pfefinance"!=t&&"pfcard"!=t||($(this).closest("div.payment_item").addClass("data_valid"),$(this).closest("div.payment_item").click())}),$("select#otrans_type").trigger("change");var e=function(e){var t=!1;$('.payone_otrans_data input[type="text"]:visible').each(function(){""===$(this).val()&&(t=!0)}),t===!0?$("table.payone_otrans_data").addClass("payone_data_missing"):$("table.payone_otrans_data").removeClass("payone_data_missing"),$(this).closest("div.payment_item").removeClass("data_valid")};$('.payone_otrans_data input[type="text"]').keyup(e),$('.payone_otrans_data input[type="text"]').change(e)},s=function(){$('table.payone_elv_data select[name="p1_elv_country"]').on("change",function(e){var t=$(this).val(),a=$("tr.only_de",$(this).closest("table"));"DE"==t?a.show("fast"):a.hide("fast")}),$('table.payone_elv_data select[name="p1_elv_country"]').trigger("change"),$(".sepadata input").on("change",function(e){var t="";$(".sepadata input").each(function(){t+=$(this).val()}),0===t.length?$("tr.only_de input").removeAttr("disabled"):$("tr.only_de input").attr("disabled","disabled")}),$(".only_de input").on("change",function(e){var t="";$(".only_de input").each(function(){t+=$(this).val()}),0===t.length?$("tr.sepadata input").removeAttr("disabled"):$("tr.sepadata input").attr("disabled","disabled")});var e=function(e){o&&console.log(e);var t=$("div.module_option_checked");if(e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))&&"VALID"==e.status)a(),$("form#checkout_payment").trigger("submit");else{var n=p1_payment_error;"string"==typeof e.customermessage&&(n=e.customermessage),$("p.p1_error",t).html(n),$("p.p1_error",t).show(),t.closest("div.payment_item").removeClass("data_valid"),t.get(0).scrollIntoView()}},a=function(){var e=$('input[name="payment"]:checked');$("p.p1_error",e.closest("div.payment_item")).hide(),$("table.payone_elv_data").hide(),$("div.p1_finaldata_elv").show(),$("td.final_elv_country").html($("select#p1_elv_country option").filter(":selected").html()),$("td.final_elv_accountnumber").html($("input#p1_elv_accountnumber").val()),$("td.final_elv_bankcode").html($("input#p1_elv_bankcode").val()),$("td.final_elv_iban").html($("input#p1_elv_iban").val()),$("td.final_elv_bic").html($("input#p1_elv_bic").val()),e.closest("div.payment_item").addClass("data_valid"),$("table.payone_elv_data").removeClass("payone_paydata")},n=function(n){var l=$('select[name="p1_elv_country"] option').filter(":selected").val(),i=$('input[name="p1_elv_accountnumber"]',t).val(),c=$('input[name="p1_elv_bankcode"]',t).val(),s=$('input[name="p1_elv_iban"]',t).val(),p=$('input[name="p1_elv_bic"]',t).val();if("none"==p1_elv_checkmode)a();else{n.preventDefault();var _=p1_elv_config,r=new PAYONE.Gateway(_,e),d={};d=s.length>0?{iban:s,bic:p,bankcountry:l}:{bankaccount:i,bankcode:c,bankcountry:l},o&&console.log(d),r.call(d)}};$("form#checkout_payment").on("submit",function(e){var t=$('input[name="payment"]:checked');"payone_elv"===t.val()&&t.closest("div.payment_item").hasClass("data_valid")===!1&&n(e)})},p=function(){var e=function(){var e=$("#p1_safeinv_type").val();$("tr.p1-safeinv-agreement").not(".p1-show-for-"+e).hide(),$("tr.p1-show-for-"+e).show()};$('select[name="safeinv_type"]').on("change",e),e()};return l.init=function(e){o&&console.log("payone_checkout module initializing, submodule "+n.module),"cc"==n.module&&$("form#checkout_payment").on("submit",i),"otrans"==n.module&&c(),"elv"==n.module&&s(),"safeinv"==n.module&&p(),e()},l});